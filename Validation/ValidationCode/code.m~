
%% Validation of the image haze model

% Riddhish Bhalodia and Alankar Kotwal

input_image = (imread('hazefree.png'));

% The atmospheric light and the transmission map are taken from one of the
% processed hazy image, adn as the code is for images which are scaled by
% 1/4 we need to scale the test image too before applying the A and tx onto
% it. Then we will scale the output back to original and run it throught
% the algorithm and we will weather the predicted tx and A are the same as
% that of the applied ones.

input_image = double(input_image)./255;

atmos_light = load('A.mat');
tx_map = load('tx.mat');

A = imresize(atmos_light.e,4);
tx = imresize(tx_map.c,4);
haze_image_estimate = zeros(size(input_image));

for c = 1:3
    haze_image_estimate(:,:,c) = (input_image(:,:,c) - A(:,1:1366)).*(max(tx(:,1:1366), 0.1)) + A(:,1:1366);
end

for i = 1:

% The tx_estimate and A_estimate are obtained by running the code on the
% haze_image_estimate. Now we will compre the original and the estimated tx
% and A.

atmos_light_estimate = load('A_estimate.mat');
tx_map_estimate = load('tx_estimate.mat');

A_estimate = atmos_light_estimate.e;
tx_estimate = tx_map_estimate.c;


